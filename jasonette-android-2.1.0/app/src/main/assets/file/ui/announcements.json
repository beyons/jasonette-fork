{
  "$jason": {
    "head": {
      "title": "Render dynamic announcements page with request data",
      "data": {
        "annonces": {
          "@": "https://beyons.alwaysdata.net/jasonette/data.annonces.json"
        }
      },
      "actions": {
        "$load": {
          "type": "$render"
        },
        "$pull": {
          "type": "$reload"
        }
      },
      "templates": {
        "body": {
          "style": {
            "background": "{{$global.background}}",
            "color": "{{$global.fontColor}}",
            "border": "none",
            "align": "center"
          },
          "header": {
            "title": "Nos annonces",
            "style": {
              "font": "Roboto",
              "size": 25,
              "background": "#2d3436",
              "color": "white"
            },
            "leftButton": {
              "text": "‹",
              "style": {
                "size": 75,
                "width": 20,
                "minWidth": 90,
                "color": "white",
                "background": "#2d3436"
              },
              "action": {
                "type": "$back"
              }
            }
          },
          "sections": [
            {
              "style": {
                "align": "center"
              },
              "items": {
                "{{#each annonces}}":
                {
                  "type": "vertical",
                  "style": {
                    "color": "white",
                    "width": "100%"
                  },
                  "components": [
                    {
                      "type": "horizontal",
                      "style":{
                        "background": "{{col}}",
                        "align": "center"
                      },
                      "components": [
                        {
                          "type": "image",
                          "url": "{{image1}}",
                          "style": {
                            "width": "110",
                            "height": "110"
                          }
                        },
                        {
                          "type": "vertical",
                          "style": {
                            "background": "{{col}}",
                            "align": "center"
                          },
                          "components": [
                            {
                              "type": "label",
                              "text": "{{title}}",
                              "style": {
                                "font": "Roboto-bold",
                                "size": 17,
                                "color": "#2c3e50",
                                "padding_left": 20,
                                "padding_right": 20
                              }
                            },
                            {
                              "type": "label",
                              "text": "{{(Number.parseFloat(price).toFixed(2).replace(/\\d(?=(\\d{3})+\\.)/g, '$&,'))}}",
                              "style": {
                                "font": "Roboto-bold",
                                "size": 15,
                                "color": "{{col1}}",
                                "padding_left": 20,
                                "padding_right": 20,
                                "padding_top": 20,
                                "padding_bottom": 20
                              }
                            }
                          ]
                        },
                        {
                          "type": "button",
                          "text": "{{button}}",
                          "style": {
                            "width": 60,
                            "height": 60,
                            "background": "{{col}}",
                            "color": "#2c3e50",
                            "font": "Roboto-Bold",
                            "size": 20
                          },
                          "action": {
                              "type": "$href",
                              "options": {
                                "url": "file://ui/announcements_details.json",
                                "transition": "push",
                                "animation": "pushleft",
                                "view": "jason",
                                "params":{
                                  "title": "{{title}}",
                                  "ref": "{{ref}}",
                                  "image1": "{{image1}}",
                                  "image2": "{{image2}}",
                                  "image3": "{{image3}}",
                                  "image4": "{{image4}}",
                                  "image5": "{{image5}}",
                                  "price": "{{(Number.parseFloat(price).toFixed(2).replace(/\\d(?=(\\d{3})+\\.)/g, '$&,'))}}",
                                  "location": "{{location}}",
                                  "circulation": "{{circulation}}",
                                  "km": "{{kilometrage}}",
                                  "couleur": "{{couleur}}",
                                  "garantie": "{{garantie}}",
                                  "puissance": "{{puissance}}",
                                  "din": "{{din}}",
                                  "premieremain": "{{premieremain}}",
                                  "accessoir1": "{{accessoires1}}",
                                  "accessoir2": "{{accessoires2}}",
                                  "accessoir3": "{{accessoires3}}",
                                  "accessoir4": "{{accessoires4}}"
                                }
                              }
                          }
                        }
                      ]
                    },
                    {
                      "type": "space",
                      "style": {
                        "height": 2
                      }
                    }
                  ]
                }
              }
            }
          ],
          "layers": [
            {
              "type": "textfield",
              "name": "search",
              "placeholder": "Que recherchez vous?",
              "style": {
                "placeholder_color": "#cecece",
                "font": "Roboto",
                "align": "left",
                "width": "200",
                "background": "#ffffff",
                "height": "50",
                "autocorrect": "true",
                "autocapitalize": "true",
                "spellcheck": "true",
                "size": 15,
                "width": "100%-50",
                "left": 25,
                "top": 80
              }
            },
            {
              "type": "button",
              "text": "Rechercher",
              "style": {
                "width": "100%-50",
                "left": 25,
                "top": 135,
                "height": "50",
                "background": "#e74c3c",
                "color": "#ffffff",
                "font": "Roboto",
                "size": "15"
              },
              "action": {
                "type": "$network.request",
                "options": {
                  "url": "https://beyons.alwaysdata.net/jasonette/search.engine.php?choice={{$get.search}}",
                  "data_type": "jason"
                },
                "success": {
                  "type": "$timer.start",
                  "options": {
                    "interval": "1",
                    "name": "waiting",
                    "action": {
                      "type": "$href",
                      "options": {
                        "url": "file://ui/search_result.json",
                        "transition": "push",
                        "animation": "pushleft",
                        "view": "jason"
                      }
                    }
                  }
                },
                "error": {
                  "type": "$util.alert",
                  "options": {
                    "title": "Erreur",
                    "description": "Uh oh, quelque chose s'est mal passé"
                  }
                }
              }
            },
            {
              "type": "button",
              "url": "file://images/writes.png",
              "style": {
                "width": 60,
                "height": 60,
                "right": 20,
                "bottom": 20,
                "background": "#2980B9",
                "color": "#ffffff",
                "font": "Roboto",
                "size": 30,
                "elevation": 20,
                "corner_radius": 75
              }
            }
          ]
        }
      }
    }
  }
}